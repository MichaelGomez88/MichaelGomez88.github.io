<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Timeline</title>
    <link rel="stylesheet" href="https://fonts.googleapis.com/css2?family=Comfortaa:wght@300;400;700&display=swap">
    <style>
        body {
            background-color: #faa5d1;
            color: white;
            text-align: center;
            font-family: 'Comfortaa', sans-serif;
            font-size: 22px;
        }

        #menu-icon {
            display: flex;
            flex-direction: column;
            cursor: pointer;
            position: fixed;
            top: 15px;
            left: 15px;
            z-index: 2;
        }

        .bar {
            width: 35px;
            height: 5px;
            background-color: white;
            margin: 6px 0;
            transition: 0.4s;
        }

        #sidebar {
            width: 200px;
            height: 100vh;
            position: fixed;
            top: 0;
            left: -200px;
            background: #ff69b4;
            padding-top: 50px;
            transition: 0.4s;
            z-index: 3;
        }

        #sidebar a {
            display: block;
            color: white;
            padding: 15px;
            text-decoration: none;
            text-align: center;
        }

        #sidebar a:hover {
            background: #ff4081;
        }

        .timeline {
            position: relative;
            max-width: 1200px;
            margin: 50px auto;
        }

        .timeline::after {
            content: '';
            position: absolute;
            width: 6px;
            background-color: white;
            top: 0;
            bottom: 0;
            left: 50%;
            margin-left: -3px;
        }

        .container {
            padding: 10px 40px;
            position: relative;
            background-color: inherit;
            width: 50%;
        }

        .container::after {
            content: '';
            position: absolute;
            width: 25px;
            height: 25px;
            right: -17px;
            background-color: white;
            border: 4px solid #ff4081;
            top: 15px;
            border-radius: 50%;
            z-index: 1;
        }

        .left {
            left: -8%;
        }
        .right { 
            left: 50%;
        }

        .container.left .content {
            margin-left: 5%;
            margin-right: 0;
        }

        .left::before {
            content: " ";
            position: absolute;
            top: 22px;
            right: 30px;
            border: medium solid white;
            border-width: 10px 0 10px 10px;
            border-color: transparent transparent transparent white;
        }

        .right::before {
            content: " ";
            position: absolute;
            top: 22px;
            left: 30px;
            border: medium solid white;
            border-width: 10px 10px 10px 0;
            border-color: transparent white transparent transparent;
        }

        .right::after { left: -16px; }

        .content {
            padding: 20px 30px;
            background-color: white;
            color: #ff4081;
            position: relative;
            border-radius: 6px;
        }

        .content img {
            width: 100%;
            max-width: 300px;
            display: block;
            margin: 10px auto 0;
            border-radius: 10px;
            box-shadow: 0px 4px 8px rgba(0, 0, 0, .2);
        }

        @media screen and (max-width: 600px) {
            .timeline::after { left: 31px; }
            .container { width: 100%; padding-left: 70px; padding-right: 25px; }
            .container::before { left: 60px; border-width: 10px 10px 10px 0; border-color: transparent white transparent transparent; }
            .left::after, .right::after { left: 15px; }
            .right { left: 0%; }
        }
    </style>

    <!-- Firebase SDKs -->
<script src="https://www.gstatic.com/firebasejs/10.12.2/firebase-app.js"></script>
<script src="https://www.gstatic.com/firebasejs/10.12.2/firebase-firestore.js"></script>
<script src="https://www.gstatic.com/firebasejs/10.12.2/firebase-storage.js"></script>

</head>
<body>
<div id="menu-icon" onclick="toggleMenu()">
    <div class="bar"></div>
    <div class="bar"></div>
    <div class="bar"></div>
</div>

<div id="sidebar">
    <a href="home.html">Home</a>
    <a href="index.html">Quiz</a>
    <a href="timeline.html">Timeline</a>
</div>

<div class="timeline">
    <div class="container left">
        <div class="content">
            <h2>01/23/2021</h2>
            <p>This is the first time we spoke via IG. Kind of tough... lmk link in bio. This was when I had accidentally answered your story thing about selling a fish tank lol</p>
            <img src="images/First DM.png" alt="">
        </div>
    </div>
    
    <div class="container right">
        <div class="content">
            <h2>12/26/2024</h2>
            <p>I requested to follow you and you confronted me with the fabled line: "You come around like every 1-3 years don't you"... You said you were feeling mischeivous that day, but I theorize it was a bit more</p>
            <img src="images/Confrontation.png" alt="">
        </div>
    </div>

    <div class="container left">
        <div class="content">
            <h2>12/27/2024</h2>
            <p>I finally made it out of the request purgatory!!! After 1 whole day of chatting, and getting to hear about your lore lol It was a pretty funny moment I think...</p>
            <img src="images/Confrontation.png" alt="">
        </div>
    </div>

    <div class="container right">
        <div class="content">
            <h2>12/28/2024</h2>
            <p>When I got your number. You gave it after this video I was trying to send wouldn't work lol it just sucked butt and couldn't play. Oh well... I guess it led to somewhere fire afterall</p>
            <img src="images/First Text.png" alt="">
        </div>
    </div>

    <div class="container left">
        <div class="content">
            <h2>01/09/2025</h2>
            <p>Our first date, kind of lol (It was). I really liked the day there. I remember you talking about your relationship with each of your siblings and then going into how you felt about them all. It was really windy, and we were at Redhill. You could barely look at me but it was still nice to listen and observe.</p>
            <img src="images/First Date.jpg" alt="">
        </div>
    </div>

    <div class="container right">
        <div class="content">
            <h2>01/11/2025</h2>
            <p>Our first (second) date that we had at Chilis + first kiss at Frisbie Park. I remember it was still a little cold and chilly billy that day too, you even equipped the (neenie) beanie to withstand the coldness. Of course, I never get cold... Also I'm sorry, I look a little chopped in this but it's one of our few photos together.</p>
            <img src="images/Chili Night.jpg" alt="">
        </div>
    </div>

    <div class="container left">
        <div class="content">
            <h2>01/20/2025</h2>
            <p>The first boink. I mean it was a lot more than that but I just thought it was super memorable... you even gave a super giant heartfelt message about it! I chose this picture here because I really like to way you look in it. I feel like you barely look at me (IM NOT THAT UGLY!!!) but I think it was the one time that I couldn't see it, I thought it was nice.</p>
            <img src="images/Stare.jpg" alt="">
        </div>
    </div>

    <div class="container right">
        <div class="content">
            <h2>02/14/2025</h2>
            <p>VALENTINE'S DAY!!! I loved everything about this day. It was so nice to see the book you had made and the little ribbon that came with it. I was a HUGE fan of it all. Thank you for the work you put into that. This was also the first time we said the love word + squirting incident of '25</p>
            <img src="images/Valentine Present.jpg" alt="">
        </div>
    </div>

</div>


<hr style="margin: 50px auto; width: 80%; border: 2px dashed white;">
    <h2 style="color: white;">Add a New Memory</h2>
    <div id="new-entry-form" style="margin: 30px auto; max-width: 600px; text-align: left;">
        <label style="color: white;">Date:<br>
            <input type="date" id="entryDate" style="width: 100%; padding: 8px;">
        </label><br><br>
    
        <label style="color: white;">Description:<br>
            <textarea id="entryText" rows="4" style="width: 100%; padding: 8px;"></textarea>
        </label><br><br>
    
        <label style="color: white;">Image:<br>
            <input type="file" id="entryImage" accept="image/*" style="width: 100%;">
        </label><br><br>
    
    <button onclick="addEntry()" style="padding: 10px 20px; background-color: white; color: #ff4081; font-family: 'Comfortaa', sans-serif; border: none; border-radius: 8px;">Add to Timeline</button>
    </div>

<script>
    function toggleMenu() {
        var sidebar = document.getElementById("sidebar");
        sidebar.style.left = sidebar.style.left === "0px" ? "-200px" : "0px";
    }

    // Initialize Firebase
    const firebaseConfig = {
        apiKey: "AIzaSyD4ncrWW9qUu110DHmywtgAHLcfB0v08mE",
        authDomain: "neen-website-db.firebaseapp.com",
        projectId: "neen-website-db",
        storageBucket: "neen-website-db.appspot.com",
        messagingSenderId: "665808845797",
        appId: "1:665808845797:web:affb1f831d7caffb998d0c",
        measurementId: "G-ZRB6C9HW43"
    };

    firebase.initializeApp(firebaseConfig);
    const db = firebase.firestore();
    const storage = firebase.storage();


    /*
        OLD ADD ENTRY
    
    function addEntry() {
        const date = document.getElementById("entryDate").value;
        const text = document.getElementById("entryText").value;
        const fileInput = document.getElementById("entryImage");
        const file = fileInput.files[0];

        if (!date || !text || !file) {
            alert("Please complete all fields.");
            return;
        }

        // Alternate sides: left → right → left → right
        const containers = document.querySelectorAll('.timeline .container');
        const lastIsRight = containers.length > 0 && containers[containers.length - 1].classList.contains('right');
        const side = lastIsRight ? 'left' : 'right';

        const reader = new FileReader();

        reader.onload = function (e) {
            const imgSrc = e.target.result;

            const container = document.createElement("div");
            container.className = `container ${side}`;

            const content = document.createElement("div");
            content.className = "content";
            content.innerHTML = `
                <h2>${formatDate(date)}</h2>
                <p>${text}</p>
                <img src="${imgSrc}" alt="">
            `;

            container.appendChild(content);
            document.querySelector(".timeline").appendChild(container);

            // Clear form inputs
            document.getElementById("entryDate").value = "";
            document.getElementById("entryText").value = "";
            document.getElementById("entryImage").value = "";
        };

        reader.readAsDataURL(file);
    }

    */



    /* 
        OLD SAVE ENTRY
    
    function saveEntry(entry) {
    const saved = JSON.parse(localStorage.getItem("timelineEntries")) || [];
    saved.push(entry);
    localStorage.setItem("timelineEntries", JSON.stringify(saved));
}
*/

function addEntry() {
    const date = document.getElementById("entryDate").value;
    const text = document.getElementById("entryText").value;
    const fileInput = document.getElementById("entryImage");
    const file = fileInput.files[0];

    if (!date || !text || !file) {
        alert("Please complete all fields.");
        return;
    }

    const timestamp = Date.now();
    const storageRef = storage.ref(`memories/${timestamp}_${file.name}`);

    storageRef.put(file).then(snapshot => {
        return snapshot.ref.getDownloadURL();
    }).then(imgUrl => {
        return db.collection("timelineEntries").add({
            date,
            text,
            imgUrl,
            timestamp
        });
    }).then(() => {
        alert("Memory added!");
        location.reload(); // Refresh to show the new memory
    }).catch(error => {
        console.error("Error adding entry:", error);
        alert("Something went wrong. Please try again.");
    });
}

function formatDate(input) {
    const [year, month, day] = input.split("-");
    return `${month}/${day}/${year}`;
}

/* function loadEntries() {
    const entries = JSON.parse(localStorage.getItem("timelineEntries")) || [];

    entries.forEach((entry, index) => {
        const side = index % 2 === 0 ? 'left' : 'right';
        const container = document.createElement("div");
        container.className = `container ${side}`;

        const content = document.createElement("div");
        content.className = "content";

        content.innerHTML = `
            <h2>${formatDate(entry.date)}</h2>
            <p>${entry.text}</p>
            <img src="${entry.imgSrc}" alt="">
        `;

        container.appendChild(content);
        document.querySelector(".timeline").appendChild(container);
    });
}
*/

function loadEntries() {
    db.collection("timelineEntries").orderBy("timestamp").get().then(snapshot => {
        const timeline = document.querySelector(".timeline");
        snapshot.docs.forEach((doc, index) => {
            const data = doc.data();
            const side = index % 2 === 0 ? 'left' : 'right';

            const container = document.createElement("div");
            container.className = `container ${side}`;

            const content = document.createElement("div");
            content.className = "content";

            content.innerHTML = `
                <h2>${formatDate(data.date)}</h2>
                <p>${data.text}</p>
                <img src="${data.imgUrl}" alt="">
            `;

            container.appendChild(content);
            timeline.appendChild(container);
        });
    });
}

window.addEventListener("DOMContentLoaded", loadEntries);

</script>
</body>
</html>
